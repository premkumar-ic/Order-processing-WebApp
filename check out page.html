<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ShopZone - Checkout</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap');
    * {
      box-sizing: border-box;
      font-family: 'Montserrat', Arial, sans-serif;
      margin: 0;
      padding: 0;
    }
    body {
      background: linear-gradient(135deg, #3A8DFF 0%, #1B3F72 100%);
      color: #1B2A41;
      padding: 30px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    header {
      width: 100%;
      max-width: 900px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 28px;
      background: rgba(255, 255, 255, 0.97);
      border-radius: 20px;
      box-shadow: 0 12px 30px rgba(0,0,0,0.13);
      margin-bottom: 30px;
      user-select: none;
    }
    .logo {
      font-size: 30px;
      font-weight: 800;
      color: #1B3F72;
      letter-spacing: 0.06em;
    }
    nav {
      display: flex;
      gap: 25px;
      align-items: center;
    }
    nav a {
      color: #1B3F72;
      font-weight: 600;
      font-size: 16px;
      text-decoration: none;
      padding: 8px 16px;
      border-radius: 6px;
      transition: background-color 0.2s, color 0.2s;
      user-select: none;
    }
    nav a:hover {
      background-color: #3A8DFF;
      color: #fff;
    }
    .main-content {
      width: 100%;
      max-width: 900px;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      box-shadow: 0 13px 36px rgba(0, 0, 0, 0.16);
      padding: 36px 28px;
      margin-top: 10px;
      display: flex;
      flex-direction: column;
      gap: 32px;
    }
    h2 {
      font-size: 32px;
      color: #145397;
      font-weight: 700;
      margin-bottom: 16px;
      user-select: none;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 16px;
    }
    th,
    td {
      padding: 12px 10px;
      border-bottom: 1px solid #dde6f4;
      font-size: 15px;
      text-align: left;
    }
    th {
      background: #eef3fc;
      color: #145397;
    }
    .product-info {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .product-info img {
      width: 38px;
      height: 38px;
      border-radius: 5px;
      object-fit: cover;
    }
    .section-title {
      color: #1B3F72;
      font-size: 20px;
      font-weight: 700;
      margin: 16px 0 8px;
    }
    .checkout-form label {
      font-weight: 600;
      color: #145397;
      display: block;
      margin: 7px 0 3px;
    }
    .checkout-form input,
    .checkout-form textarea,
    .checkout-form select {
      width: 100%;
      font-size: 15px;
      border-radius: 6px;
      border: 1px solid #b2c8e0;
      padding: 9px;
      margin-bottom: 10px;
      background: #f5f9ff;
    }
    .checkout-form textarea {
      resize: vertical;
      min-height: 44px;
    }
    .total-row td {
      font-weight: 800;
      color: #2A80B9;
      font-size: 18px;
      text-align: right;
    }
    .place-order-btn {
      background: #2A80B9;
      color: #fff;
      border: none;
      border-radius: 10px;
      padding: 15px 35px;
      font-size: 17px;
      font-weight: 700;
      cursor: pointer;
      transition: background 0.2s;
      margin-top: 8px;
    }
    .place-order-btn:hover {
      background: #145397;
    }
    .card {
      background: #fdfcff;
      border-radius: 14px;
      box-shadow: 0 2px 12px #e4ecfa;
      padding: 20px;
    }
    @media (max-width: 650px) {
      .main-content, header {
        max-width: 99vw;
        padding: 10px;
      }
      th,
      td {
        font-size: 12px;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">ShopZone</div>
    <nav>
      <a href="index.html">Home</a>
      <a href="order history.html">Orders</a>
      <a href="cart page.html">Cart</a>
    </nav>
  </header>
  <div class="main-content">
    <h2>Checkout</h2>
    <div class="card">
      <div class="section-title">Your Cart Items</div>
      <table id="checkoutCartTable">
        <thead>
          <tr>
            <th>Product</th>
            <th>Name</th>
            <th>Price</th>
            <th>Qty</th>
            <th>Subtotal</th>
          </tr>
        </thead>
        <tbody id="cartTableBody">
          <!-- Cart rows inserted by JS -->
        </tbody>
        <tfoot>
          <tr class="total-row">
            <td colspan="4" style="text-align:right;">Total Amount:</td>
            <td id="cartTotal">â‚¹0</td>
          </tr>
        </tfoot>
      </table>
    </div>
    <form class="checkout-form card" id="checkoutForm" autocomplete="off">
      <div class="section-title">Shipping Address</div>
      <label for="shippingAddress">Address</label>
      <textarea id="shippingAddress" name="shippingAddress" required></textarea>
      <div class="section-title">Payment Method</div>
      <label for="paymentMethod">Select Payment Method</label>
      <select id="paymentMethod" name="paymentMethod" required>
        <option value="">-- Select --</option>
        <option value="UPI">UPI</option>
        <option value="CARD">CARD</option>
        <option value="NET_BANKING">NET BANKING</option>
      </select>
      <button class="place-order-btn" type="submit">Place Order</button>
    </form>
  </div>
  <script>
    const products = [
    { id: "prod-1001", title: "Laptop", desc: "High performance laptop", price: 1200.00, img: "https://encrypted-tbn2.gstatic.com/shopping?q=tbn:ANd9GcTjXx5CKJldU3rM9G5knz3AzmSEDQ9AnntlYkF7S7W45rmjJVecqzg1YwHVSinFnBp3kjV6vrozBSTHnCPnmYmWl76dHFcK43WZedUMcMjpipFv8Bky0Uw2EP48nxnVkOQAPELfv1AANA&usqp=CAc" },
    { id: "prod-1002", title: "MobilePhone", desc: "High performance Mobile phone", price: 8000.00, img: "https://encrypted-tbn3.gstatic.com/shopping?q=tbn:ANd9GcRXAmYRqQHO99wkXOhfM01ILpEsz1PRufprDoIapIAKajG1uGN_IqNiFkW-hkvvOZWmBNfmwm9BhNEol4M5YePVGaBpczVVHjecbhJkUWE" },
    { id: "prod-1003", title: "Wireless Mouse", desc: "Ergonomic wireless mouse with 1600 DPI optical sensor.", price: 25.50, img: "https://m.media-amazon.com/images/I/51cKJlOhorL.jpg" },
    { id: "prod-1004", title: "Mechanical Keyboard", desc: "Mechanical keyboard with RGB backlight and blue switches.", price: 85.00, img: "https://encrypted-tbn3.gstatic.com/shopping?q=tbn:ANd9GcSllmIQKRYBFTt64rOGNmPg2RwiR7GUkGYdGnOqGoFNChvZvd4N8N1i1yfhsECgpzuP8ZH85goyO0A2IToTNJUelaaSsXF8D_6rCsY9D0E" },
    { id: "prod-1005", title: "USB-C Hub", desc: "7-in-1 USB-C hub with HDMI, USB 3.0, and SD/microSD card readers.", price: 45.00, img: "https://encrypted-tbn3.gstatic.com/shopping?q=tbn:ANd9GcSiXCCqmNzFaYnkU6T4WDUJUfg35hmmSH1rCNCdHjV7AInQ6zt0o2tGj2fJ7T7ovw9__7rJNBuHrZKRzeFcfy4w-cXB1sDdU3ybkwrvYorLXRdqbWv8jm5BZQ" },
    { id: "prod-1006", title: "Noise Cancelling Headphones", desc: "Over-ear Bluetooth headphones with active noise cancellation.", price: 199.99, img: "https://m.media-amazon.com/images/I/81s-xD5h8xL._AC_SR230,210_CB1169409_QL70_.jpg" },
    { id: "prod-1007", title: "1080p HD Webcam", desc: "Full HD webcam with built-in microphone and privacy shutter.", price: 55.75, img: "https://encrypted-tbn1.gstatic.com/shopping?q=tbn:ANd9GcTO8z8nOTJm8lzVtGO-gsBvMl5eJr1gSMcVRErZno3aOXxTBIDYwsrJDAd36JGZBP6BFuZRUl382Si90Cv11QQ2M1ImzVQqqBmAexsAbA_1w84RG3vcFYHO" },
    { id: "prod-1008", title: "Gaming Chair", desc: "Ergonomic gaming chair with adjustable height and lumbar support.", price: 350.00, img: "https://encrypted-tbn1.gstatic.com/shopping?q=tbn:ANd9GcQVA-wRMJgnvUaBGyG3-oAJBKU5E4-gy1eNwiO6nxXQcrSVBt9IbxzGHfzGa2YJOfJP3I3R5fWoKiboQE9PNid2ou9qjGPIsG0dOcuB_qA6SXL3x09M2En1&usqp=CAc" },
    { id: "prod-1009", title: "27-inch 4K Monitor", desc: "Ultra HD 4K monitor with IPS panel and HDR support.", price: 399.00, img: "data:image/webp;base64,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"
    }];

    async function fetchCart() {
      try {
        const response = await fetch('https://process-order-processing-api-aj6h1h.5sc6y6-3.usa-e2.cloudhub.io/api/customer/cart', {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json',
            'client_id': 'your-client-id', // Replace with your actual client id
            'client_secret': 'your-client-secret' // Replace with your actual client secret
          }
        });
        if (!response.ok) throw new Error('Failed to fetch cart.');

        const data = await response.json();

        if (!Array.isArray(data) || !data[0] || !data[0].items) return null;

        const items = data[0].items.map(item => {
          const p = products.find(prod => prod.id.toLowerCase() === item.product_code.toLowerCase());
          return {
            img: p ? p.img : 'https://via.placeholder.com/38',
            title: p ? p.title : (item.productName || item.product_code),
            price: p ? p.price : (item.price || 0),
            quantity: item.quantity
          };
        });

        let totalAmount = data[0].total_amount;
        if (typeof totalAmount !== 'number' || totalAmount <= 0) {
          totalAmount = items.reduce((sum, i) => sum + i.price * i.quantity, 0);
        }

        return { items, totalAmount };
      } catch (e) {
        alert('Could not load your cart: ' + e.message);
        return null;
      }
    }

    function renderCartItems(cart) {
      if (!cart) return;
      const { items, totalAmount } = cart;
      const tbody = document.getElementById('cartTableBody');
      tbody.innerHTML = '';

      items.forEach(item => {
        const subtotal = item.price * item.quantity;
        const row = document.createElement('tr');
        row.innerHTML = `
          <td><div class="product-info"><img src="${item.img}" alt="${item.title}"><span>${item.title}</span></div></td>
          <td>â‚¹${item.price.toLocaleString()}</td>
          <td>${item.quantity}</td>
          <td>â‚¹${subtotal.toLocaleString()}</td>
        `;
        tbody.appendChild(row);
      });

      document.getElementById('cartTotal').textContent = `â‚¹${totalAmount.toLocaleString()}`;
    }

    async function placeOrder() {
      const address = document.getElementById('shippingAddress').value.trim();
      const paymentMethod = document.getElementById('paymentMethod').value;

      if (!address || !paymentMethod) {
        alert('Please fill out all checkout details.');
        return;
      }

      const cart = await fetchCart();
      if (!cart) return;

      const orderPayload = {
        shippingAddress: address,
        paymentMethod: paymentMethod
      };

      try {
        const response = await fetch('https://process-order-processing-api-aj6h1h.5sc6y6-3.usa-e2.cloudhub.io/api/orders', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'client_id': 'your-client-id',
            'client_secret': 'your-client-secret'
          },
          body: JSON.stringify(orderPayload)
        });

        if (response.ok) {
          window.location.href = 'order success.html';
        } else {
          const errorText = await response.text();
          alert('Failed to place order: ' + errorText);
        }
      } catch (error) {
        alert('Error placing order: ' + error.message);
      }
    }

    document.addEventListener('DOMContentLoaded', async () => {
      const cart = await fetchCart();
      renderCartItems(cart);

      document.getElementById('checkoutForm').addEventListener('submit', e => {
        e.preventDefault();
        placeOrder();
      });
    });
  </script>
